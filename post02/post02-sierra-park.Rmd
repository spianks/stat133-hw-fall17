---
title: "Post 2: Random Number Generator"
author: "Sierra Park"
date: "11/25/2017"
output: html_document
---
```{r}
#load library
library(ggplot2)
```



## Introduction 

#### Dataset: Student Admissions at UC Berkeley  

I will explore XX using the UC Berkeley Student Admissions built-in dataset in R.
This is an aggregate data on applicants to UC Berekely graduate school for the six largest departments in 1973  classied by admission and sex.
I will perform hypothesis testing to see if the admission rates for males and females are the same across the six departments. 

## What is Hypothesis Testing? 

The main purpose of hypothesis testing is to test if the data from an experiment or observation supports a hypothesis.

This process starts with forming a null hypothesis that assumes that the chances of all events are equal and that all differences are merely due to chance. On the other hand, an alternative hypothesis states that the differences are real--there is an underlying phenomenom behind the differences we see in the results. 

After forming the hypotheses, we state the alpha level in which you will use as a threshold to determine whether we should accept or fail to accept the null hypothesis. We generally choose alpha to be 5%. 

The metric that we use to determine whether the null hypothesis is true is the p-value, so-called the observed significance level. 
P-value determines how "likely" or "unlikely" we observe a more extreme test statistic in the direction of the alternative hypothesis than the one observed. 
If the p-value is small (let's say, less than or equal to alpha), then it is "unlikely"; if the p-value is large (le'ts say, more than alpha), then it is "likely."
In other words, p-value is the chance, under the null hypothesis, that the test statistic is equal to the value that was observed in the data or is even further in the direction of the alternative. 
If a p-value is small, it means that the tail beyond it is small, so the observed statistic is  away from what the null predicts, implying that the dat asupport the alternative hypothesis better than the null hypothesis.

If the p-value is less than 5%, then the result is statistically significant; if the p-value is even smaller--less than 1%--then the result is highly statistically significant, and we reject the null.

For this post, we will use two-sided hypotheesis, just to denote that there is a difference between the admission rate of males and females. 



 

## Forming Hypothesis
In our case, null hypothesis is:
$$
H = \textrm{There is no difference in the admission rate for males and females} 
$$
and alternative hypothesis is:
$$
H_\alpha  = \textrm{There is a difference in the admission rate for males and females; the difference is due to chance.} 
$$

## Observe the Data
Let's take a look at the UC Berkeley Admissions data.
```{r}
UCBAdmissions
```

We see that there are 6 departments and each of them have the number of males and females admitted and rejected students.
Hence, we will calculate the percentages of admission and rejected rate for males and females in eaach department using a for loop.



```{r}
percentadmitmale <-  rep(0, 6) #Create an empty vector for percent admitted males
percentadmitfemale <-  rep(0,6) #Create an empty vector percent admitted females 
numbermale <- rep(0,6)
numberfemale <- rep(0,6)
for (i in 1:6){ #Calculate the admitted percentage for males and females for each department
  dep <- UCBAdmissions[,,LETTERS[i]]
  numbermale[i] <- sum(dep[1,1], dep[1,2])
  numberfemale[i] <- sum(dep[2,1], dep[2,2])
  percentadmitmale[i] <- dep[1,1]/(dep[1,1] + dep[1,2])
  percentadmitfemale[i] <- dep[2,1]/(dep[2,1] + dep[2,2])
}
```


We have two vectors, *percentadmitmale* and *percentadmitfemale*, that show the percent admission for males and females, respectively.
```{r}
percentadmitfemale
percentadmitmale
```

Note that we cannot eye-ball whether the admission rate for both sexes is equal or not. Hence we will perform a hypothesis test with the hypothesis stated above. 


### Performing the Hypothesis Test
Let our observed statistic to be the difference between the admitted percentages of females and males.
```{r}
observed_statistic = abs(percentadmitfemale - percentadmitmale)
observed_statistic
```

```{r}
data.frame(observed_statistic)
ggplot(data.frame(observed_statistic)) + geom_dotplot(aes(observed_statistic))
```



We will perform z-test for difference in proportions.
* Pooled sample proportion:
Since the null hypothesis states that admission rate of females is the same as the admissio nrate of males, we use a pooled sample proportion (p) to compute the standard error of the sampling distribution.
```{r}
p <- (percentadmitfemale *numberfemale + percentadmitmale * numbermale) / (numberfemale + numbermale)
p
```

* Standard error:
Compute the standard error (SE) of the sampling distribution difference between twop roportions:
```{r}
SE <- sqrt(p*(1-p)*((1/numbermale) + (1/numberfemale)))
SE
```

* Test statistic:
The test statistic is a z-score defined by:
$$
\textrm{z = (percentadmitfemale - percentadmitmale)/SE}
$$


Hence, 
```{r}
z <- (percentadmitfemale - percentadmitmale)/SE
z
```


### Translate Z-score to P-value
Since having a z-score less than -1.96 or greater than 1.96 means more than two standard deviation away, the corresponding p-value would be less than 0.05 on either side of the bell curve. 
Hence, looking at our z vector, only the first department has an absolute value of z-value greater than 1.96. 
Therefore, the admission rate between the males and females were equal in all departments besides department A. 





### DIY
500 random people Male and Female
```{r}
draw <- sample(c("FEMALE", "MALE"), 500, replace = TRUE)
```


```{r}
f <- sum(draw=="FEMALE")
m <- sum(draw=="MALE")
```

```{r}

```
sum()

### Conclusion 
In the end, the message of this post is to understand that sometimes, a better method of seeing the relationship between variables is to use a lowess line that uses a weighted average instead 

### Sources:
1. http://www.statisticshowto.com/probability-and-statistics/hypothesis-testing/
2. https://onlinecourses.science.psu.edu/statprogram/node/138
3. https://www.inferentialthinking.com/chapters/10/2/terminology-of-testing.html
4. http://stattrek.com/hypothesis-test/difference-in-proportions.aspx
5. http://pro.arcgis.com/en/pro-app/tool-reference/spatial-statistics/what-is-a-z-score-what-is-a-p-value.htm
6. 
7. 